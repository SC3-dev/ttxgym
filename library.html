<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>TTX Gym - Exercise Library</title>
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,100..900;1,100..900&display=swap"
    rel="stylesheet">
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

  <link rel="stylesheet" href="style.css">
  <style>
    /* ─── LIBRARY LAYOUT ─── */
    #lib-wrap {
      flex: 1;
      display: flex;
      overflow: hidden;
      height: calc(100vh - 56px);
    }

    /* ─── SIDEBAR / FILTERS ─── */
    #lib-sidebar {
      width: 220px;
      min-width: 200px;
      display: flex;
      flex-direction: column;
      border-right: 1px solid var(--border);
      background: var(--mid);
      overflow-y: auto;
      flex-shrink: 0;
      padding-bottom: 1rem;
    }

    #lib-sidebar-header {
      padding: 0 1.25rem;
      height: 52px;
      display: flex;
      align-items: center;
      border-bottom: 1px solid var(--border);
      flex-shrink: 0;
    }

    #lib-sidebar-header h2 {
      font-size: 1rem;
      font-weight: 700;
      letter-spacing: 0.1em;
      text-transform: uppercase;
      color: var(--text-muted);
      font-family: var(--font-mono);
    }

    /* Search */
    .search-wrap {
      padding: 0.75rem 1.25rem 0;
      flex-shrink: 0;
    }

    .search-input-wrap {
      position: relative;
    }

    .search-input-wrap svg {
      position: absolute;
      left: 0.6rem;
      top: 50%;
      transform: translateY(-50%);
      width: 14px;
      height: 14px;
      fill: var(--text-muted);
      pointer-events: none;
    }

    #search {
      width: 100%;
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      color: var(--text-primary);
      font-family: var(--font-display);
      font-size: 13px;
      padding: 0.45rem 0.75rem 0.45rem 2rem;
      transition: border-color 0.15s, box-shadow 0.15s;
      outline: none;
    }

    #search::placeholder {
      color: var(--text-muted);
    }

    #search:focus {
      border-color: var(--border-active);
      box-shadow: 0 0 0 3px var(--accent-glow);
    }

    /* Filter Groups */
    .filter-group {
      padding: 0.75rem 1.25rem 0;
    }

    .filter-group-label {
      font-family: var(--font-mono);
      font-weight: 500;
      text-transform: uppercase;
      color: var(--text-primary);
      padding-bottom: 0.5rem;
      display: flex;
      align-items: center;
      gap: 0.4rem;
      border-bottom: 1px solid var(--border);
      margin-bottom: 0.5rem;
    }

    .filter-group-label svg {
      width: 1rem;
      height: 1rem;
      fill: var(--text-primary);
      flex-shrink: 0;
    }

    .filter-group label {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      color: var(--text-secondary);
      font-size: 12.5px;
      padding: 0.25rem 0;
      cursor: pointer;
      transition: color 0.12s;
      user-select: none;
    }

    .filter-group label:hover {
      color: var(--text-primary);
    }

    .filter-group input[type="checkbox"] {
      appearance: none;
      -webkit-appearance: none;
      width: 14px;
      height: 14px;
      border: 1px solid rgba(255, 255, 255, 0.2);
      border-radius: 3px;
      background: var(--surface);
      flex-shrink: 0;
      cursor: pointer;
      transition: all 0.12s;
      position: relative;
    }

    .filter-group input[type="checkbox"]:checked {
      background: var(--accent);
      border-color: var(--accent);
    }

    .filter-group input[type="checkbox"]:checked::after {
      content: '';
      position: absolute;
      left: 3px;
      top: 1px;
      width: 5px;
      height: 8px;
      border: 2px solid #fff;
      border-top: none;
      border-left: none;
      transform: rotate(45deg);
    }

    /* ─── MAIN CONTENT ─── */
    #lib-main {
      flex: 1;
      display: flex;
      flex-direction: column;
      overflow: hidden;
    }

    #lib-topbar {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 0 1.5rem;
      height: 52px;
      border-bottom: 1px solid var(--border);
      background: var(--mid);
      flex-shrink: 0;
      gap: 1rem;
    }

    #lib-topbar h1 {
      font-size: 14px;
      font-weight: 700;
      color: var(--text-primary);
      letter-spacing: -0.01em;
    }

    #result-count {
      font-family: var(--font-mono);
      font-size: 11px;
      color: var(--text-muted);
    }

    /* ─── GALLERY ─── */
    #gallery-scroll {
      flex: 1;
      overflow-y: auto;
      padding: 1.25rem;
    }

    #gallery {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(18rem, 1fr));
      gap: 1rem;
      align-content: flex-start;
    }

    .ex-tile {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: var(--radius-lg);
      cursor: pointer;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      overflow: hidden;
      aspect-ratio: 4 / 3;
      transition: border-color 0.18s, box-shadow 0.18s, transform 0.18s;
      position: relative;
    }

    .ex-tile:hover {
      border-color: var(--border-active);
      box-shadow: 0 0 0 1px var(--accent-glow), 0 8px 28px rgba(0, 0, 0, 0.45);
      transform: translateY(-2px);
    }

    .ex-tile h3 {
      padding: 1rem 1rem 0.75rem;
      font-size: 1rem;
      font-weight: 700;
      margin: 0;
      background: linear-gradient(180deg, rgba(20, 24, 32, 0.9) 0%, rgba(20, 24, 32, 0) 100%);
      color: var(--text-primary);
      letter-spacing: -0.01em;
      line-height: 1.35;
    }

    .ex-attributes {
      display: flex;
      justify-content: space-around;
      padding: 0.6rem 0.5rem 0.75rem;
      background: linear-gradient(0deg, rgba(20, 24, 32, 0.95) 60%, rgba(20, 24, 32, 0) 100%);
      gap: 0.25rem;
    }

    .ex-attr {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 0.2rem;
      font-family: var(--font-mono);
      font-size: 10px;
      color: var(--text-muted);
      text-align: center;
    }

    .ex-attr-val {
      font-size: 11px;
      color: var(--text-secondary);
      font-weight: 500;
    }

    .ex-attr-icon {
      width: 14px;
      height: 14px;
      opacity: 0.5;
    }

    /* ─── MODAL ─── */
    .modal {
      display: none;
      position: fixed;
      inset: 0;
      background: rgba(0, 0, 0, 0.72);
      justify-content: center;
      align-items: center;
      z-index: 500;
      backdrop-filter: blur(4px);
    }

    .modal.open {
      display: flex;
    }

    .modal-content {
      background: var(--mid);
      border: 1px solid var(--border);
      border-radius: var(--radius-lg);
      overflow: hidden;
      width: min(680px, 92vw);
      max-height: 85vh;
      display: flex;
      flex-direction: column;
      box-shadow: 0 24px 64px rgba(0, 0, 0, 0.6);
      color: var(--text-primary);
    }

    .modal-header {
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      min-height: 180px;
      background: var(--surface);
      background-size: cover;
      background-position: center;
      background-blend-mode: multiply;
      flex-shrink: 0;
      position: relative;
    }

    .modal-header-top {
      display: flex;
      justify-content: flex-end;
      padding: 0.75rem 0.75rem 0;
    }

    #close-modal {
      background: rgba(20, 24, 32, 0.9);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      width: 2rem;
      height: 2rem;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      color: var(--text-secondary);
      font-size: 16px;
      transition: all 0.15s;
      flex-shrink: 0;
    }

    #close-modal:hover {
      background: var(--surface-raised);
      color: var(--text-primary);
    }

    #modal-title {
      font-size: 18px;
      font-weight: 700;
      padding: 1rem 1.5rem 1.25rem;
      background: linear-gradient(0deg, rgba(30, 37, 53, 0.97) 0%, transparent 100%);
      letter-spacing: -0.02em;
      line-height: 1.3;
    }

    .modal-body {
      flex: 1;
      overflow-y: auto;
      display: flex;
      flex-direction: column;
    }

    .modal-actions {
      display: flex;
      gap: 0.5rem;
      padding: 1rem 1.5rem 0.75rem;
      border-bottom: 1px solid var(--border);
      flex-shrink: 0;
    }

    .btn {
      display: inline-flex;
      align-items: center;
      gap: 0.4rem;
      padding: 0.45rem 1rem;
      border-radius: var(--radius);
      font-family: var(--font-display);
      font-size: 13px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.15s;
      border: 1px solid transparent;
      text-decoration: none;
    }

    .btn-primary {
      background: var(--accent);
      color: #fff;
      border-color: var(--accent);
    }

    .btn-primary:hover {
      background: var(--accent-hover);
      border-color: var(--accent-hover);
    }

    .btn-secondary {
      background: var(--accent-glow);
      color: var(--accent);
      border-color: var(--border-active);
    }

    .btn-secondary:hover {
      background: var(--surface-raised);
      color: var(--accent-hover);
    }

    .btn svg {
      width: 14px;
      height: 14px;
      fill: currentColor;
      flex-shrink: 0;
    }

    #modal-summary {
      padding: 1rem 1.5rem;
      font-size: 13px;
      line-height: 1.7;
      flex: 1;
    }

    .modal-meta {
      display: flex;
      gap: 0.75rem;
      padding: 0 1.5rem 1rem;
      flex-wrap: wrap;
      border-top: 1px solid var(--border);
      padding-top: 0.75rem;
      flex-shrink: 0;
    }

    .meta-pill {
      display: inline-flex;
      align-items: center;
      gap: 0.35rem;
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: 99px;
      padding: 0.25rem 0.65rem;
      font-size: 11.5px;
      color: var(--text-secondary);
      font-family: var(--font-mono);
    }

    .meta-pill svg {
      width: 12px;
      height: 12px;
      fill: var(--text-muted);
      flex-shrink: 0;
    }

    .modal-tags {
      padding: 0.75rem 1.5rem;
      display: flex;
      align-items: center;
      gap: 0.5rem;
      flex-wrap: wrap;
      border-bottom: 1px solid var(--border);
      flex-shrink: 0;
    }

    .modal-tags-label {
      font-family: var(--font-mono);
      font-size: 10px;
      text-transform: uppercase;
      letter-spacing: 0.08em;
      color: var(--text-muted);
      flex-shrink: 0;
    }

    .tag-chip {
      display: inline-flex;
      align-items: center;
      background: var(--green-glow);
      border: 1px solid rgba(62, 201, 200, 0.2);
      color: var(--green);
      border-radius: 3px;
      padding: 0.15rem 0.45rem;
      font-size: 11px;
      font-family: var(--font-mono);
    }

    /* ─── EMPTY STATE ─── */
    .empty-state {
      grid-column: 1 / -1;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: 4rem 2rem;
      gap: 0.75rem;
      color: var(--text-muted);
      text-align: center;
    }

    .empty-state svg {
      width: 36px;
      height: 36px;
      fill: var(--text-muted);
      opacity: 0.4;
    }

    .empty-state p {
      font-size: 13px;
    }

    /* ─── MOBILE ─── */
    @media (max-width: 768px) {
      #lib-wrap {
        flex-direction: column;
        height: auto;
        overflow: visible;
      }

      #lib-sidebar {
        width: 100%;
        min-width: unset;
        border-right: none;
        border-bottom: 1px solid var(--border);
        overflow: visible;
      }

      #lib-sidebar.collapsed .filter-group,
      #lib-sidebar.collapsed .search-wrap {
        display: none;
      }

      #gallery-scroll {
        overflow: visible;
      }

      .modal-content {
        width: 100%;
        max-height: 100vh;
        border-radius: 0;
      }
    }
  </style>
</head>

<body>


  <!-- ══════════════════════════════════════════
       NAVIGATION
       ══════════════════════════════════════════ -->
  <nav id="site-nav" role="navigation" aria-label="Main navigation">
    <a href="/" class="nav-logo" aria-label="TTX Gym Home">
      <svg viewBox="0 0 210 84" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
        <g>
          <path style="fill:#ffffff"
            d="m 123.95944,30.43245 0.001,-1.117375 5.11724,-6.112717 c 2.81453,-3.361993 5.11729,-6.171028 5.11729,-6.242298 0,-0.07123 -2.30323,-2.881476 -5.1183,-6.244894 l -5.1183,-6.1153013 v -1.086954 -1.086943 l 3.28003,0.0063 3.28005,0.0063 3.8207,4.544782 c 2.10139,2.499633 3.91803,4.6295583 4.03697,4.7331703 0.18592,0.161956 0.77129,-0.476686 4.17186,-4.5515563 l 3.95559,-4.739934 h 3.28934 3.28932 v 1.052384 1.052384 l -5.19039,6.1834383 c -2.85472,3.400899 -5.1886,6.219979 -5.18639,6.264626 0.002,0.04464 2.33524,2.838581 5.18451,6.208731 l 5.18051,6.127543 0.006,1.117375 0.006,1.117376 -3.28004,-0.0032 -3.28003,-0.0032 -4.03542,-4.764205 c -3.77303,-4.454434 -4.04959,-4.7469 -4.25324,-4.498099 -0.1198,0.146359 -1.92418,2.291532 -4.00975,4.767043 l -3.792,4.500917 h -3.23672 -3.23673 l 0.001,-1.117376 z" />
          <path style="fill:#ffffff"
            d="M 103.62935,20.159802 V 8.7697787 h -5.767107 -5.767099 v -3.171906 -3.171905 h 14.634016 14.63402 v 3.171905 3.171906 h -5.69501 -5.69501 V 20.159802 31.549826 h -3.1719 -3.17191 z" />
          <path style="fill:#ffffff"
            d="M 71.045229,20.159802 V 8.7697787 h -5.695017 -5.695007 v -3.171906 -3.171905 h 14.561929 14.561929 v 3.171905 3.171906 H 83.084046 77.38904 V 20.159802 31.549826 h -3.171906 -3.171905 z" />
          <path style="fill:#1a6ec0"
            d="m 56.568246,44.749266 c 0.132103,-1.130608 0.11982,-5.393817 -0.01826,-6.336905 l -0.09381,-0.640428 h 50.057284 50.05728 l -0.0914,0.775254 c -0.14125,1.198686 -0.15482,4.546774 -0.0241,5.932418 l 0.1177,1.247158 H 106.51352 56.453986 Z" />
          <path style="fill:#1a6ec0"
            d="m 200.94868,51.986986 c 0,-0.01984 -0.19934,-0.522652 -0.44235,-1.117376 -0.24303,-0.594734 -0.62663,-1.835993 -0.85249,-2.758363 -1.17752,-4.80902 -0.86406,-9.679602 0.90117,-14.002281 l 0.57405,-1.405726 h 4.0357 4.03569 l -0.26157,0.39649 c -1.23002,1.864399 -2.0063,3.624311 -2.54655,5.77324 -0.26627,1.059149 -0.3139,1.638572 -0.30464,3.706429 0.0142,3.191363 0.30209,4.354515 1.81632,7.340458 l 1.06655,2.103165 h -4.01068 c -2.20589,0 -4.01093,-0.01625 -4.0112,-0.03609 z" />
          <path style="fill:#1a6ec0"
            d="m 3.0885296,51.941186 c 0,-0.04506 0.44678,-0.969549 0.99284,-2.054529 1.56297,-3.105469 1.81674,-4.159426 1.81148,-7.523519 -0.003,-2.117705 -0.0453,-2.529327 -0.38251,-3.748616 -0.62502,-2.259971 -1.27274,-3.70054 -2.47959,-5.514785 l -0.26374,-0.396489 h 4.03913 4.0391284 l 0.508459,1.214635 c 1.175244,2.807495 1.592501,5.008816 1.600805,8.445255 0.0084,3.455866 -0.441579,6.004916 -1.515078,8.583574 l -0.448069,1.076317 H 7.0399596 c -2.17329,0 -3.95143,-0.03683 -3.95143,-0.08188 z" />
          <path style="fill:#1a6ec0"
            d="m 188.14448,64.45835 c -4.60694,-9.066036 -6.34795,-19.950671 -4.79103,-29.952887 0.79263,-5.092105 2.34256,-10.128325 4.37061,-14.201486 l 0.75375,-1.513865 5.15491,-0.03788 5.15492,-0.03788 -1.44187,2.36676 c -1.68405,2.764325 -2.62234,4.771433 -3.60217,7.705364 -1.48568,4.448683 -2.16923,8.595656 -2.16312,13.123333 0.0109,8.068699 2.41694,16.120002 6.77075,22.656654 0.44893,0.674024 0.86412,1.306609 0.92263,1.405726 0.0843,0.142814 -0.97051,0.180221 -5.08108,0.180221 h -5.18744 z" />
          <path style="fill:#1a6ec0"
            d="M 13.442562,64.890886 C 21.430959,52.97521 22.612598,37.550731 16.537975,24.485129 16.224594,23.811095 15.34227,22.237758 14.577265,20.988827 L 13.186333,18.71803 h 5.166097 5.166087 l 0.803415,1.698254 c 5.365207,11.340999 6.308978,24.008992 2.687685,36.076248 -0.753947,2.512395 -1.94733,5.507012 -3.117002,7.821643 l -0.928945,1.838262 h -5.183434 -5.183435 z" />
          <path style="fill:#1a6ec0"
            d="m 174.53173,78.948193 c -5.15518,-8.267119 -8.66247,-19.326858 -9.79592,-30.890037 -0.24331,-2.48236 -0.24156,-10.536496 0.003,-12.975982 1.12233,-11.203007 4.06279,-20.780917 9.1843,-29.9160563 l 1.53618,-2.74015 h 5.47631 5.47631 l -0.49924,0.68484 c -2.41341,3.310656 -5.29765,8.4418153 -7.00382,12.4600833 -6.83569,16.098892 -7.07266,34.022086 -0.66592,50.365278 1.74301,4.446298 4.74992,9.997815 7.52608,13.895014 0.41656,0.58477 0.72226,1.12003 0.67935,1.18946 -0.0429,0.0694 -2.43321,0.12626 -5.31175,0.12626 h -5.23371 z" />
          <path style="fill:#ffffff"
            d="M 121.65153,67.017498 V 52.888101 l 3.13587,5.7e-4 3.13586,5.8e-4 3.17191,3.780699 c 1.74455,2.079391 3.89837,4.64314 4.78628,5.697244 l 1.61436,1.916538 4.77081,-5.697761 4.77081,-5.69787 h 3.16659 3.16657 v 14.129397 14.129405 h -3.09878 -3.09876 l -0.0371,-9.382769 -0.037,-9.382768 -4.75785,5.697085 c -2.61683,3.1334 -4.7903,5.700884 -4.82996,5.705506 -0.0397,0.0042 -2.24556,-2.565511 -4.90203,-5.711405 l -4.82995,-5.719804 -0.037,9.397077 -0.0371,9.397078 h -3.02668 -3.02669 z" />
          <path style="fill:#ffffff"
            d="m 100.45743,75.865912 v -5.280979 l -1.344169,-1.819764 c -0.739298,-1.000858 -3.6589,-4.950452 -6.487984,-8.776859 -2.829095,-3.826422 -5.143811,-6.989316 -5.143811,-7.028665 0,-0.03936 1.617879,-0.07154 3.595271,-0.07154 h 3.595282 l 4.42039,5.550836 c 2.431221,3.05296 4.432961,5.550842 4.448301,5.550842 0.0153,0 2.00418,-2.497006 4.41964,-5.54889 l 4.39174,-5.548884 3.64048,-0.0021 c 2.00227,-0.001 3.64048,0.03218 3.64048,0.07376 0,0.04168 -1.83591,2.555739 -4.0798,5.586882 -2.24389,3.031139 -5.16348,6.979234 -6.48798,8.773567 l -2.40819,3.262401 v 5.280114 5.2801 h -3.09983 -3.09982 z" />
          <path style="fill:#ffffff"
            d="m 62.502123,80.992853 c -1.603358,-0.38525 -3.146168,-1.67929 -3.90041,-3.2715 l -0.460373,-0.97187 v -9.731985 -9.731983 l 0.47064,-0.962093 c 0.817123,-1.670376 2.149173,-2.774973 3.881596,-3.2188 0.768181,-0.196799 2.098574,-0.22127 10.08887,-0.185561 9.200985,0.04115 9.204277,0.04126 10.016894,0.369845 1.187347,0.480148 2.594836,1.823046 3.180052,3.034115 0.444291,0.91942 0.467685,1.054456 0.522915,3.017034 l 0.05783,2.05453 h -3.115852 -3.115852 v -1.153422 -1.153422 h -8.003075 -8.003064 l 0.03725,7.965804 0.03725,7.965814 7.965804,0.03725 7.965804,0.03725 v -2.163882 -2.163893 h -3.027719 -3.02773 v -3.02772 -3.02773 h 6.134855 6.134866 l -0.04337,6.019414 -0.04337,6.019405 -0.463865,0.94788 c -0.594481,1.21481 -1.698782,2.31911 -2.913576,2.91359 l -0.947886,0.46386 -9.443633,0.0241 c -5.211651,0.0133 -9.686177,-0.0342 -9.984879,-0.106 z" />
          <path style="fill:#1a6ec0"
            d="m 25.519705,81.021453 c -0.0439,-0.071 0.03978,-0.28263 0.185983,-0.47036 1.311927,-1.68534 3.639855,-5.502462 5.220114,-8.559464 C 37.220777,59.814061 39.557125,45.873306 37.606851,32.126537 36.200366,22.212685 32.499604,12.59703 26.939043,4.4084047 l -1.3462,-1.982437 5.436392,0.0021 5.436382,0.0021 1.40982,2.557101 c 2.522363,4.575035 4.243812,8.5214633 5.769337,13.2262383 6.107588,18.835993 4.615545,39.223717 -4.167783,56.950123 -0.589373,1.189457 -1.607315,3.006103 -2.262092,4.036963 l -1.190513,1.87431 -5.212463,0.0379 c -2.957294,0.0214 -5.24697,-0.0179 -5.292218,-0.0912 z" />
        </g>
      </svg>
    </a>
    <ul class="nav-links">
      <li><a href="index.html">About</a></li>
      <li><a href="guide.html">How To Use</a></li>
      <li><a href="library.html" class="active">Exercise Library</a></li>
      <li><a href="editor.html">Exercise Builder</a></li>
      <li><a href="gym/" class="launch">Launch</a></li>
    </ul>
    <button class="nav-hamburger" onclick="document.getElementById('mobile-nav').classList.toggle('open')"
      aria-label="Toggle menu">&#9776;</button>
  </nav>

  <div id="mobile-nav" role="navigation" aria-label="Mobile navigation">
    <a href="index.html">About</a>
    <a href="guide.html">How To Use</a>
    <a href="library.html">Exercise Library</a>
    <a href="editor.html">Exercise Builder</a>
    <a href="gym/" class="launch">Launch</a>
  </div>

  <!-- MAIN LIBRARY LAYOUT -->
  <div id="lib-wrap">

    <!-- SIDEBAR -->
    <aside id="lib-sidebar">
      <div id="lib-sidebar-header">
        <h2>Filters</h2>
      </div>

      <div class="search-wrap" style="padding-top:0.75rem;">
        <div class="search-input-wrap">
          <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
            <path d="M21 21l-4.35-4.35M17 11A6 6 0 1 1 5 11a6 6 0 0 1 12 0z" fill="none" stroke="currentColor"
              stroke-width="2" stroke-linecap="round" />
          </svg>
          <input type="text" id="search" placeholder="Search scenarios…">
        </div>
      </div>

      <div class="filter-group" id="category-filter">
        <div class="filter-group-label">
          <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
            <path
              d="M21.41 11.58l-9-9A2 2 0 0 0 11 2H4a2 2 0 0 0-2 2v7a2 2 0 0 0 .59 1.42l9 9a2 2 0 0 0 2.82 0l7-7a2 2 0 0 0 0-2.84zM7 9a2 2 0 1 1 0-4 2 2 0 0 1 0 4z" />
          </svg>
          Tags
        </div>
      </div>

      <div class="filter-group" id="level-filter">
        <div class="filter-group-label">
          <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
            <path d="M4 20v-4h4v4H4zm6 0V12h4v8h-4zm6 0V4h4v16h-4z" />
          </svg>
          Level
        </div>
      </div>

      <div class="filter-group" id="duration-filter">
        <div class="filter-group-label">
          <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
            <path d="M12 2a10 10 0 1 0 0 20A10 10 0 0 0 12 2zm.5 11H11V7h1.5v5.25l3.75 2.25-.75 1.25L12.5 13z" />
          </svg>
          Duration
        </div>
      </div>

      <div class="filter-group" id="author-filter">
        <div class="filter-group-label">
          <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
            <path d="M12 12a5 5 0 1 0 0-10 5 5 0 0 0 0 10zm0 2c-5.33 0-8 2.67-8 4v2h16v-2c0-1.33-2.67-4-8-4z" />
          </svg>
          Author
        </div>
      </div>

      <div style="flex:1"></div>
    </aside>

    <!-- MAIN CONTENT -->
    <div id="lib-main">
      <div id="lib-topbar">
        <h1>Exercise Library</h1>
        <span id="result-count"></span>
      </div>
      <div id="gallery-scroll">
        <div id="gallery"></div>
      </div>
    </div>
  </div>

  <!-- MODAL -->
  <div id="modal" class="modal">
    <div class="modal-content">
      <div class="modal-header" id="modal-header">
        <div class="modal-header-top">
          <span id="close-modal" title="Close">&#x2715;</span>
        </div>
        <h2 id="modal-title"></h2>
      </div>
      <div class="modal-body">
        <div class="modal-actions">
          <a id="starter" href="#" class="btn btn-primary">
            <svg viewBox="0 0 24 24">
              <path d="M5 3l14 9-14 9V3z" />
            </svg>
            Launch
          </a>
          <a id="downloader" href="#" download class="btn btn-secondary">
            <svg viewBox="0 0 24 24">
              <path d="M12 16l-5-5h3V4h4v7h3l-5 5zm-7 4v-2h14v2H5z" />
            </svg>
            Download
          </a>
        </div>
        <div class="modal-tags" id="modal-tags-wrap">
          <span class="modal-tags-label">Tags</span>
          <div id="tag-content"></div>
        </div>
        <p id="modal-summary"></p>
        <div class="modal-meta" id="modal-attributes"></div>
      </div>
    </div>
  </div>

  <!-- ══════════════════════════════════════════
       FOOTER
       ══════════════════════════════════════════ -->
  <footer id="site-footer">
    <div class="footer-inner">
      <span class="footer-copy">© 2026 TTX Gym. All rights reserved.</span>
      <a href="mailto:contact@ttxgym.com" class="footer-contact">contact@ttxgym.com</a>
    </div>
  </footer>

  <script>
    var exs = [];

    // SVG icons inline
    const iconLevel = `<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" style="width:12px;height:12px;fill:currentColor;opacity:0.5"><path d="M4 20v-4h4v4H4zm6 0V12h4v8h-4zm6 0V4h4v16h-4z"/></svg>`;
    const iconClock = `<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" style="width:12px;height:12px;fill:currentColor;opacity:0.5"><path d="M12 2a10 10 0 1 0 0 20A10 10 0 0 0 12 2zm.5 11H11V7h1.5v5.25l3.75 2.25-.75 1.25L12.5 13z"/></svg>`;
    const iconAuthor = `<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" style="width:12px;height:12px;fill:currentColor;opacity:0.5"><path d="M12 12a5 5 0 1 0 0-10 5 5 0 0 0 0 10zm0 2c-5.33 0-8 2.67-8 4v2h16v-2c0-1.33-2.67-4-8-4z"/></svg>`;

    function handleFileSelect() {
      fetch("lib/manifest.json")
        .then(r => { if (!r.ok) throw new Error(r.statusText); return r.text(); })
        .then(data => {
          exs = JSON.parse(data);
          document.getElementById('close-modal').addEventListener('click', closeModal);
          document.getElementById('modal').addEventListener('click', e => { if (e.target === document.getElementById('modal')) closeModal(); });
          document.getElementById('search').addEventListener('input', filterexs);
          initializeFilters();
          displayexs(exs);

          // Auto-open modal if ?q= param is present in URL
          const urlParams = new URLSearchParams(window.location.search);
          const qParam = urlParams.get('q');
          if (qParam) {
            const match = exs.find(ex => ex.image === qParam || ex.id === qParam);
            if (match) openModal(match);
          }
        })
        .catch(err => console.error('Fetch error:', err));
    }

    function displayexs(list) {
      const gallery = document.getElementById('gallery');
      gallery.innerHTML = '';
      document.getElementById('result-count').textContent = list.length + ' scenario' + (list.length !== 1 ? 's' : '');

      if (list.length === 0) {
        gallery.innerHTML = `<div class="empty-state">
          <svg viewBox="0 0 24 24"><path d="M11 19a8 8 0 1 0 0-16 8 8 0 0 0 0 16zm10 2-4-4"/></svg>
          <p>No scenarios match your filters.</p>
        </div>`;
        return;
      }

      list.forEach(ex => {
        const tile = document.createElement('div');
        tile.classList.add('ex-tile');

        if (ex.image) {
          tile.style.backgroundImage = `url(lib/images/${ex.image}.png)`;
          tile.style.backgroundSize = 'cover';
          tile.style.backgroundPosition = 'center';
        }

        tile.innerHTML = `
          <h3>${ex.title}</h3>
          <div class="ex-attributes">
            <div class="ex-attr">
              ${iconLevel}
              <span class="ex-attr-val">${ex.level || '—'}</span>
            </div>
            <div class="ex-attr">
              ${iconAuthor}
              <span class="ex-attr-val">${ex.author || '—'}</span>
            </div>
            <div class="ex-attr">
              ${iconClock}
              <span class="ex-attr-val">${ex.duration || '—'}</span>
            </div>
          </div>
        `;
        tile.addEventListener('click', () => openModal(ex));
        gallery.appendChild(tile);
      });
    }

    function filterexs() {
      const searchValue = document.getElementById('search').value.toLowerCase();
      const selectedCategories = Array.from(document.querySelectorAll('#category-filter input:checked')).map(el => el.value);
      const selectedLevels = Array.from(document.querySelectorAll('#level-filter input:checked')).map(el => el.value);
      const selectedAuthors = Array.from(document.querySelectorAll('#author-filter input:checked')).map(el => el.value);
      const selectedDurations = Array.from(document.querySelectorAll('#duration-filter input:checked')).map(el => el.value);

      const filtered = exs.filter(ex => {
        const matchesCategory = selectedCategories.length === 0 || (ex.categories && ex.categories.some(c => selectedCategories.includes(c)));
        const matchesLevel = selectedLevels.length === 0 || selectedLevels.includes(ex.level);
        const matchesAuthor = selectedAuthors.length === 0 || selectedAuthors.includes(ex.author);
        const matchesDuration = selectedDurations.length === 0 || selectedDurations.includes(ex.duration);
        const matchesSearch = ex.title.toLowerCase().includes(searchValue) || (ex.summary && ex.summary.toLowerCase().includes(searchValue));
        return matchesCategory && matchesLevel && matchesDuration && matchesSearch && matchesAuthor;
      });

      displayexs(filtered);
    }

    function initializeFilters() {
      const categories = [...new Set(exs.flatMap(ex => ex.categories || []))];
      const levels = [...new Set(exs.map(ex => ex.level).filter(Boolean))];
      const durations = [...new Set(exs.map(ex => ex.duration).filter(Boolean))];
      const authors = [...new Set(exs.map(ex => ex.author).filter(Boolean))];

      function addCheckboxes(containerId, values) {
        const container = document.getElementById(containerId);
        values.forEach(val => {
          const label = document.createElement('label');
          label.innerHTML = `<input type="checkbox" value="${val}"> ${val}`;
          label.querySelector('input').addEventListener('change', filterexs);
          container.appendChild(label);
        });
      }

      addCheckboxes('category-filter', categories);
      addCheckboxes('level-filter', levels);
      addCheckboxes('author-filter', authors);
      addCheckboxes('duration-filter', durations);
    }

    function openModal(ex) {
      document.getElementById('modal-title').textContent = ex.title;
      document.getElementById('modal-summary').innerHTML = ex.summary || '';

      // Tags
      const tagContent = document.getElementById('tag-content');
      tagContent.innerHTML = (ex.categories || []).map(c => `<span class="tag-chip">${c}</span>`).join(' ');

      // Attributes
      document.getElementById('modal-attributes').innerHTML = `
        <div class="meta-pill">${iconLevel} ${ex.level || '—'}</div>
        <div class="meta-pill">${iconAuthor} ${ex.author || '—'}</div>
        <div class="meta-pill">${iconClock} ${ex.duration || '—'}</div>
      `;

      document.getElementById('downloader').href = `lib/scenarios/${ex.image}.ttxf`;
      document.getElementById('starter').href = `gym?q=${ex.image}`;

      // Modal header background
      const header = document.getElementById('modal-header');
      if (ex.image) {
        header.style.backgroundImage = `url(lib/images/${ex.image}.png)`;
        header.style.backgroundSize = 'cover';
        header.style.backgroundPosition = 'center';
        header.style.backgroundColor = '';
        header.style.backgroundBlendMode = 'normal';
      } else {
        header.style.backgroundImage = 'none';
        header.style.backgroundColor = 'var(--surface)';
        header.style.backgroundBlendMode = 'normal';
      }

      document.getElementById('modal').classList.add('open');
      history.pushState({ q: ex.image }, '', '?q=' + encodeURIComponent(ex.image));
    }

    function closeModal() {
      document.getElementById('modal').classList.remove('open');
      history.pushState({}, '', window.location.pathname);
    }

    function toggleMobileNav() {
      const links = document.getElementById('main-nav-links');
      links.classList.toggle('open');
    }

    handleFileSelect();
  </script>
</body>

</html>